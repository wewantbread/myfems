:root {
  --cycle-duration: 20s;
  --air-color: 198 72% 72%;
  --leaf-color: 118 54% 44%;
  --water-color: 192 64% 58%;
  --fire-color: 32 88% 56%;
  --outline-color: 198 84% 78%;
  --chakra-third-eye: 356 84% 60%;
  --bg-gradient: radial-gradient(
      circle at 50% 44%,
      hsl(42 98% 96%) 0%,
      hsl(210 56% 92%) 40%,
      hsl(220 48% 86%) 100%
    ),
    linear-gradient(180deg, hsl(210 40% 96%) 0%, hsl(210 32% 88%) 100%);
  --focus-glow: radial-gradient(circle at 50% 48%, hsla(0 0% 100% / 0.6) 0%, transparent 55%);
  --toggle-bg: hsla(0 0% 100% / 0.45);
  --toggle-border: hsla(220 40% 30% / 0.25);
  --toggle-icon: hsl(40 90% 55%);
  --toggle-icon-night: hsl(210 90% 82%);
  --text-color: hsl(220 32% 22%);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  position: relative;
  min-height: 100vh;
  color-scheme: light;
  color: var(--text-color);
  background: var(--bg-gradient);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: "Inter", "Helvetica Neue", system-ui, -apple-system, sans-serif;
  overflow: hidden;
  transition: background 0.6s ease, color 0.6s ease;
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: var(--focus-glow);
  pointer-events: none;
  mix-blend-mode: screen;
  opacity: 0.85;
  transition: opacity 0.6s ease, background 0.6s ease;
}

body[data-theme="night"] {
  color-scheme: dark;
  --air-color: 198 82% 80%;
  --leaf-color: 118 58% 54%;
  --water-color: 192 72% 70%;
  --fire-color: 32 92% 66%;
  --bg-gradient: #000;
  --focus-glow: radial-gradient(circle at 50% 46%, hsla(210 100% 85% / 0.2) 0%, transparent 65%);
  --toggle-bg: hsla(230 80% 12% / 0.6);
  --toggle-border: hsla(210 100% 85% / 0.3);
  --toggle-icon: hsl(46 96% 62%);
  --toggle-icon-night: hsl(210 90% 86%);
  --text-color: hsl(220 18% 92%);
}

body[data-theme="night"]::before {
  opacity: 0.5;
  mix-blend-mode: screen;
}

.theme-toggle {
  position: fixed;
  top: 2.8rem;
  right: 2.8rem;
  width: 3.25rem;
  height: 3.25rem;
  border: 1px solid var(--toggle-border);
  border-radius: 999px;
  background: var(--toggle-bg);
  backdrop-filter: blur(8px);
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: border-color 0.3s ease, background 0.3s ease, transform 0.3s ease;
  z-index: 3;
}

.theme-toggle:hover,
.theme-toggle:focus-visible {
  transform: scale(1.05);
  border-color: hsla(210 82% 52% / 0.6);
  outline: none;
  box-shadow: 0 0 0 0.25rem hsla(210 82% 52% / 0.2);
}

.theme-toggle__icon {
  width: 1.8rem;
  height: 1.8rem;
  border-radius: 50%;
  position: absolute;
  transition: opacity 0.4s ease, transform 0.4s ease;
}

.theme-toggle__icon--sun {
  background: radial-gradient(circle at center, var(--toggle-icon) 0%, hsl(46 98% 70%) 45%, hsla(46 100% 80% / 0.4) 100%);
  box-shadow: 0 0 0.5rem hsla(46 98% 60% / 0.5), 0 0 1.2rem hsla(46 98% 55% / 0.35);
  opacity: 1;
}

.theme-toggle__icon--sun::after {
  content: "";
  position: absolute;
  inset: -0.45rem;
  border-radius: 50%;
  background: radial-gradient(circle at center, hsla(46 96% 65% / 0.35) 0%, transparent 70%);
  filter: blur(1px);
  opacity: 0.75;
}

.theme-toggle__icon--moon {
  background: radial-gradient(circle at 65% 35%, var(--toggle-icon-night) 0%, hsl(230 40% 40%) 85%);
  box-shadow: inset -0.25rem -0.2rem 0.55rem hsla(210 60% 90% / 0.28);
  transform: translateY(0.5rem) scale(0.6);
  opacity: 0;
}

.theme-toggle__icon--moon::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 50%;
  box-shadow: -0.6rem 0 0 0 hsla(230 72% 20% / 0.65);
  transform: translateX(0.25rem);
}

body[data-theme="night"] .theme-toggle__icon--sun {
  opacity: 0;
  transform: translateY(-0.5rem) scale(0.6);
}

body[data-theme="night"] .theme-toggle__icon--moon {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.stage {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6vmin;
  position: relative;
  isolation: isolate;
}

.stage::before {
  content: "";
  position: absolute;
  inset: 10% 15% 8% 15%;
  border-radius: 50%;
  background: radial-gradient(circle at 50% 45%, hsla(210 60% 95% / 0.75) 0%, hsla(210 40% 70% / 0.2) 55%, transparent 78%);
  filter: blur(40px);
  opacity: 0.7;
  mix-blend-mode: screen;
  z-index: 0;
  transition: opacity 0.6s ease, background 0.6s ease;
}

body[data-theme="night"] .stage::before {
  background: radial-gradient(circle at 50% 46%, hsla(198 90% 82% / 0.22) 0%, hsla(198 96% 70% / 0.12) 45%, transparent 78%);
  opacity: 0.72;
  mix-blend-mode: screen;
}

.figure {
  position: relative;
  width: min(36vmin, 280px);
  max-width: 280px;
  aspect-ratio: 3 / 4;
  display: grid;
  place-items: center;
}

.figure__image {
  position: relative;
  z-index: 2;
  width: 100%;
  height: auto;
  display: block;
  filter: drop-shadow(0 0 1.5rem rgba(0, 0, 0, 0.18)) drop-shadow(0 0 3.5rem hsla(210 58% 65% / 0.28));
}

body[data-theme="night"] .figure__image {
  filter: drop-shadow(0 0 1.4rem hsla(210 90% 10% / 0.6)) drop-shadow(0 0 4.2rem hsla(210 100% 78% / 0.38));
}

.figure__outline {
  position: absolute;
  inset: -11%;
  pointer-events: none;
  z-index: 3;
  background: radial-gradient(
      closest-side,
      hsla(var(--outline-color) / 0) 56%,
      hsla(var(--outline-color) / 0.86) 74%,
      hsla(var(--outline-color) / 0) 96%
    );
  -webkit-mask: url("chakragirl.png") center / contain no-repeat;
  mask: url("chakragirl.png") center / contain no-repeat;
  filter:
    blur(12px)
    drop-shadow(0 0 1.8rem hsla(var(--outline-color) / 0.42))
    drop-shadow(0 0 3.8rem hsla(var(--outline-color) / 0.22));
  mix-blend-mode: screen;
  opacity: 0.78;
  animation: outline-breath 6.6s ease-in-out infinite;
}

.chakra {
  position: absolute;
  inset: auto;
  width: clamp(14px, 2.7vmin, 22px);
  height: clamp(14px, 2.7vmin, 22px);
  border-radius: 999px;
  pointer-events: none;
  z-index: 4;
  background: radial-gradient(circle at center, hsl(var(--chakra-third-eye) / 0.95) 0%, hsl(var(--chakra-third-eye) / 0.78) 55%, hsla(var(--chakra-third-eye) / 0) 100%);
  box-shadow: 0 0 1.2rem hsla(var(--chakra-third-eye) / 0.68), 0 0 2.8rem hsla(var(--chakra-third-eye) / 0.24);
}

.chakra::after {
  content: "";
  position: absolute;
  inset: -40%;
  border-radius: inherit;
  background: radial-gradient(circle at center, hsla(var(--chakra-third-eye) / 0.5) 0%, hsla(var(--chakra-third-eye) / 0.08) 55%, transparent 100%);
  filter: blur(4px);
  opacity: 0.75;
}

.chakra--third-eye {
  top: 33.5%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: chakra-breath 4.8s ease-in-out infinite;
}

.aura {
  position: absolute;
  inset: -14%;
  pointer-events: none;
  z-index: 1;
  opacity: 0;
}

/* shared breathing helper */
@keyframes breath-pulse {
  0%,
  100% {
    opacity: 0.65;
    transform: scale(0.98);
  }
  40% {
    opacity: 1;
    transform: scale(1.02);
  }
  60% {
    opacity: 0.8;
    transform: scale(1);
  }
}

/* AIR --------------------------------------------------- */
.aura--air {
  animation: air-cycle var(--cycle-duration) linear infinite;
  z-index: 2;
}

@keyframes air-cycle {
  0%,
  6% {
    opacity: 0;
  }
  12%,
  34% {
    opacity: 1;
  }
  40%,
  100% {
    opacity: 0;
  }
}

.aura--air::before,
.aura--air::after {
  content: "";
  position: absolute;
  inset: -12%;
  background-repeat: no-repeat;
  background-position: center;
  mix-blend-mode: screen;
  pointer-events: none;
}

.aura--air::before {
  background: radial-gradient(
      closest-side,
      hsla(var(--outline-color) / 0) 58%,
      hsla(var(--outline-color) / 0.8) 78%,
      hsla(var(--outline-color) / 0) 99%
    );
  -webkit-mask: url("chakragirl.png") center / contain no-repeat;
  mask: url("chakragirl.png") center / contain no-repeat;
  filter: blur(12px) saturate(1.25);
  opacity: 0.76;
  animation: outline-breath 6.4s ease-in-out infinite;
}

.aura--air::after {
  inset: -16%;
  background: conic-gradient(
    from 0deg,
    hsla(var(--air-color) / 0.02) 0deg 20deg,
    hsla(var(--air-color) / 0.5) 60deg,
    hsla(var(--air-color) / 0.18) 110deg,
    hsla(var(--air-color) / 0.04) 160deg,
    hsla(var(--air-color) / 0.38) 220deg,
    hsla(var(--air-color) / 0.08) 280deg,
    hsla(var(--air-color) / 0.45) 340deg,
    hsla(var(--air-color) / 0.02) 360deg
  );
  -webkit-mask: url("chakragirl.png") center / contain no-repeat;
  mask: url("chakragirl.png") center / contain no-repeat;
  filter: blur(28px) saturate(1.32);
  opacity: 0.5;
  animation: air-orbit 14s ease-in-out infinite;
}

@keyframes air-orbit {
  0%,
  100% {
    transform: scale(0.98);
    opacity: 0.46;
  }
  45% {
    transform: scale(1.05);
    opacity: 0.58;
  }
  70% {
    transform: scale(1.01);
    opacity: 0.5;
  }
}

.air-flow,
.air-trace {
  position: absolute;
  inset: -14%;
  mix-blend-mode: screen;
  pointer-events: none;
  -webkit-mask: url("chakragirl.png") center / contain no-repeat;
  mask: url("chakragirl.png") center / contain no-repeat;
}

.air-flow {
  background: conic-gradient(
    from 40deg,
    hsla(var(--air-color) / 0) 0deg 30deg,
    hsla(var(--air-color) / 0.58) 70deg,
    hsla(var(--air-color) / 0.26) 110deg,
    hsla(var(--air-color) / 0.04) 150deg,
    hsla(var(--air-color) / 0.42) 210deg,
    hsla(var(--air-color) / 0.16) 260deg,
    hsla(var(--air-color) / 0.52) 320deg,
    hsla(var(--air-color) / 0) 360deg
  );
  filter: blur(30px) saturate(1.36);
  opacity: 0.44;
  transform-origin: center;
  animation: air-flow-loop 16s ease-in-out infinite;
}

.air-flow--secondary {
  animation-duration: 20s;
  opacity: 0.36;
  filter: blur(32px) saturate(1.24);
}

@keyframes air-flow-loop {
  0%,
  100% {
    transform: scale(0.96);
    opacity: 0.4;
  }
  40% {
    transform: scale(1.06);
    opacity: 0.54;
  }
  70% {
    transform: scale(1.01);
    opacity: 0.48;
  }
}

.air-trace {
  background: radial-gradient(
      closest-side,
      hsla(var(--outline-color) / 0) 60%,
      hsla(var(--outline-color) / 0.72) 78%,
      hsla(var(--outline-color) / 0) 98%
    );
  filter: blur(20px) saturate(1.24);
  opacity: 0.58;
  transform-origin: center;
  animation: air-trace-glide 9s ease-in-out infinite;
}

.air-trace--two {
  animation-delay: -3.6s;
  opacity: 0.5;
  filter: blur(18px) saturate(1.14);
}

@keyframes air-trace-glide {
  0%,
  100% {
    transform: scale(0.97);
    opacity: 0.46;
  }
  36% {
    transform: scale(1.05);
    opacity: 0.58;
  }
  68% {
    transform: scale(1.01);
    opacity: 0.5;
  }
}

@keyframes outline-breath {
  0%,
  100% {
    opacity: 0.62;
    transform: scale(0.995);
  }
  45% {
    opacity: 0.86;
    transform: scale(1.02);
  }
  70% {
    opacity: 0.75;
    transform: scale(1.005);
  }
}

@keyframes chakra-breath {
  0%,
  100% {
    transform: translate(-50%, -50%) scale(0.88);
    box-shadow: 0 0 0.8rem hsla(var(--chakra-third-eye) / 0.62), 0 0 2.2rem hsla(var(--chakra-third-eye) / 0.18);
  }
  42% {
    transform: translate(-50%, -50%) scale(1.06);
    box-shadow: 0 0 1.6rem hsla(var(--chakra-third-eye) / 0.75), 0 0 3.4rem hsla(var(--chakra-third-eye) / 0.32);
  }
  68% {
    transform: translate(-50%, -50%) scale(0.98);
    box-shadow: 0 0 1.1rem hsla(var(--chakra-third-eye) / 0.7), 0 0 2.6rem hsla(var(--chakra-third-eye) / 0.26);
  }
}

/* LEAVES ------------------------------------------------ */
.aura--leaves {
  animation: leaf-cycle var(--cycle-duration) linear infinite;
}

.aura--leaves::after {
  content: "";
  position: absolute;
  inset: -18%;
  background:
    radial-gradient(circle at 30% 70%, hsla(var(--leaf-color) / 0.38) 0%, transparent 55%),
    radial-gradient(circle at 70% 60%, hsla(var(--leaf-color) / 0.28) 0%, transparent 60%),
    radial-gradient(circle at 50% 40%, hsla(var(--leaf-color) / 0.22) 0%, transparent 65%);
  filter: blur(10px);
  opacity: 0;
  mix-blend-mode: screen;
  animation: leaf-dust var(--cycle-duration) linear infinite;
}

@keyframes leaf-cycle {
  0%,
  24% {
    opacity: 0;
  }
  26% {
    opacity: 0.45;
  }
  29%,
  49% {
    opacity: 1;
  }
  51% {
    opacity: 0.4;
  }
  54%,
  100% {
    opacity: 0;
  }
}

.leaf {
  position: absolute;
  top: 50%;
  left: 50%;
  width: clamp(8px, 2vmin, 18px);
  height: clamp(16px, 3.4vmin, 26px);
  background: radial-gradient(circle at 30% 30%, hsl(var(--leaf-color) / 0.92) 0%, hsl(var(--leaf-color) / 0.6) 55%, hsl(var(--leaf-color) / 0.08) 100%);
  border-radius: 48% 52% 46% 54%;
  transform-origin: center calc(120% + var(--index) * 0.4px);
  opacity: 0;
  filter: blur(0.2px) saturate(1.2);
  animation: leaf-spiral 5s ease-in-out infinite;
  animation-delay: calc(var(--index) * 0.12s);
}

.leaf::after {
  content: "";
  position: absolute;
  inset: 18% 42% 18% 42%;
  border-radius: 50%;
  background: hsl(var(--leaf-color) / 0.32);
}

@keyframes leaf-spiral {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(0deg) translateX(3.4vmin) rotate(0deg) scale(0.7);
  }
  18% {
    opacity: 1;
  }
  52% {
    transform: translate(-50%, -50%) rotate(300deg) translateX(2.2vmin) rotate(-300deg) scale(0.92);
    opacity: 0.88;
  }
  70% {
    transform: translate(-50%, -50%) rotate(420deg) translateX(1.2vmin) rotate(-420deg) scale(0.7);
    opacity: 0.35;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(540deg) translateX(3.4vmin) rotate(-540deg) scale(0.7);
  }
}

@keyframes leaf-dust {
  0%,
  24% {
    opacity: 0;
    transform: translateY(16%) scale(0.9);
  }
  30% {
    opacity: 0.55;
    transform: translateY(0%) scale(1);
  }
  48% {
    opacity: 0.12;
    transform: translateY(-20%) scale(1.14);
  }
  54%,
  100% {
    opacity: 0;
    transform: translateY(16%) scale(0.9);
  }
}

/* WATER ------------------------------------------------ */
.aura--water {
  animation: water-cycle var(--cycle-duration) linear infinite;
}

@keyframes water-cycle {
  0%,
  49% {
    opacity: 0;
  }
  51% {
    opacity: 0.45;
  }
  54%,
  74% {
    opacity: 1;
  }
  76% {
    opacity: 0.42;
  }
  79%,
  100% {
    opacity: 0;
  }
}

.water-ribbon {
  position: absolute;
  inset: 16% 10% 24% 10%;
  border-radius: 48% 52% 50% 50% / 58% 52% 48% 42%;
  border: 1px solid hsla(var(--water-color) / 0.32);
  background: linear-gradient(115deg, hsla(var(--water-color) / 0.12) 0%, hsla(var(--water-color) / 0.52) 45%, hsla(var(--water-color) / 0.22) 100%);
  filter: blur(14px) saturate(1.45);
  mix-blend-mode: screen;
  opacity: 0.85;
  animation: water-ribbon-drift 6s ease-in-out infinite;
}

.water-ribbon--outer {
  inset: 12% 6% 18% 6%;
  border-radius: 54% 46% 56% 44% / 44% 58% 44% 58%;
  filter: blur(16px) saturate(1.55);
  animation-delay: -3s;
}

@keyframes water-ribbon-drift {
  0% {
    transform: rotate(-12deg) scale(0.94);
  }
  50% {
    transform: rotate(32deg) scale(1.08);
  }
  100% {
    transform: rotate(68deg) scale(0.94);
  }
}

.droplet {
  position: absolute;
  top: 50%;
  left: 50%;
  width: clamp(6px, 1.4vmin, 12px);
  height: clamp(12px, 3vmin, 18px);
  border-radius: 50% 50% 60% 60% / 60% 60% 40% 40%;
  background: radial-gradient(circle at 50% 30%, #fff 0%, hsla(var(--water-color) / 0.9) 55%, hsla(var(--water-color) / 0.22) 100%);
  opacity: 0;
  transform: translate(-50%, -50%);
  animation: droplet-loop 5.5s linear infinite;
  animation-delay: calc(var(--offset) * 0.65s);
}

@keyframes droplet-loop {
  0% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(0deg) translateX(2.8vmin) rotate(0deg) scale(0.64);
  }
  15% {
    opacity: 0.92;
  }
  50% {
    transform: translate(-50%, -50%) rotate(200deg) translateX(1.8vmin) rotate(-200deg) scale(0.84);
    opacity: 0.7;
  }
  70% {
    transform: translate(-50%, -50%) rotate(300deg) translateX(1.2vmin) rotate(-300deg) scale(0.7);
    opacity: 0.38;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) rotate(360deg) translateX(2.8vmin) rotate(-360deg) scale(0.64);
  }
}

/* FIRE ------------------------------------------------- */
.aura--fire {
  animation: fire-cycle var(--cycle-duration) linear infinite;
}

@keyframes fire-cycle {
  0%,
  74% {
    opacity: 0;
  }
  76% {
    opacity: 0.45;
  }
  79%,
  99% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

.aura--fire::before {
  content: "";
  position: absolute;
  inset: 26% 18% 36% 18%;
  border-radius: 52% 48% 56% 44% / 70% 70% 44% 40%;
  background: radial-gradient(circle at 50% 80%, hsla(var(--fire-color) / 0.55) 0%, hsla(var(--fire-color) / 0.12) 60%, transparent 100%);
  filter: blur(22px) saturate(1.4);
  opacity: 0.75;
  mix-blend-mode: screen;
  animation: fire-glow 4.8s ease-in-out infinite;
}

@keyframes fire-glow {
  0%,
  100% {
    transform: scale(0.94);
    opacity: 0.55;
  }
  40% {
    transform: scale(1.08);
    opacity: 0.9;
  }
  60% {
    transform: scale(1.02);
    opacity: 0.7;
  }
}

.ember {
  position: absolute;
  bottom: 22%;
  left: 50%;
  width: clamp(4px, 1.2vmin, 7px);
  height: clamp(16px, 3.4vmin, 26px);
  border-radius: 50% 50% 46% 46% / 60% 60% 40% 40%;
  background: linear-gradient(180deg, hsla(var(--fire-color) / 0.95) 0%, hsla(var(--fire-color) / 0.48) 60%, hsla(var(--fire-color) / 0) 100%);
  filter: blur(0.4px);
  opacity: 0;
  transform-origin: center 140%;
  animation: ember-rise 5.4s ease-in-out infinite;
  animation-delay: calc(var(--ember) * 0.38s);
}

@keyframes ember-rise {
  0% {
    opacity: 0;
    transform: translate(-50%, 40%) rotate(-20deg) translateY(0) scale(0.68);
  }
  18% {
    opacity: 1;
  }
  48% {
    transform: translate(-50%, -140%) rotate(18deg) translateX(0.3vmin) scale(0.95);
    opacity: 0.88;
  }
  70% {
    transform: translate(-50%, -210%) rotate(36deg) translateX(0.6vmin) scale(0.72);
    opacity: 0.42;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, 40%) rotate(70deg) translateY(0) scale(0.62);
  }
}

@media (prefers-reduced-motion: reduce) {
  .aura,
  .figure__outline,
  .air-flow,
  .air-trace,
  .leaf,
  .water-ribbon,
  .droplet,
  .ember,
  .chakra {
    animation: none !important;
    opacity: 0 !important;
  }
}
